Notes 

http://hcahpsonline.org/files/HCAHPS%20Fact%20Sheet%20May%202012.pdf 

SELECT *, effective_care.score, RANK() OVER (PARTITION BY measure_id ORDER BY (effective_care.score)) FROM effective_care WHERE effective_care.measure_id IN ('AMI_2', 'AMI_10', 'IMM_2', 'ED_1b') AND effective_care.score !='Not Available'

CREATE TABLE effective_care_transform AS SELECT *, RANK() OVER (PARTITION BY measure_id ORDER BY (effective_care.score)) as measure_rank FROM effective_care WHERE effective_care.measure_id IN ('IMM_2', 'ED_1b') AND effective_care.score !='Not Available'

SELECT effective_care_transform.hospital_name, SUM(effective_care_transform.measure_rank) FROM effective_care_transform GROUP BY effective_care_transform.state

Need to update to add other two conditions that are positive

AM_2 Aspirin prescribed at discharge (higher is better)
AMI_10 Statin at Discharge (higher is better)
IMM_2 Immunization for influenza (stats to influenza) (higher is better)
SCIP_INF_1 â€“ higher is better (surgical metric)


CREATE TABLE effective_care_state_transform AS SELECT *, RANK() OVER (PARTITION BY effective_care_state.measure_id ORDER BY (effective_care_state.score)) as measure_rank FROM effective_care_state WHERE effective_care_state.measure_id IN ('AMI_2', 'AMI_10', 'IMM_2', ' SCIP_INF_1') AND effective_care_state.score !='Not Available'

SELECT effective_care_state_transform.state, SUM(effective_care_state_transform.measure_rank) FROM effective_care_state_transform GROUP BY effective_care_state_transform.state


JOIN SELECT variance(effective_care_state.score)
